<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="user">

	<select id="getCnt" parameterType="hashmap" resultType="Integer">
		SELECT COUNT(*)
		FROM CARDS
		WHERE 1=1
		<if test="searchTxt != null and searchTxt != ''">
         	<choose>
            	<when test="searchGbn == 1">
            		AND CARD_NAME LIKE '%' || #{searchTxt} || '%'
            	</when>
            		<when test="searchGbn == 2">
            		AND CARD_NO LIKE '%' || #{searchTxt} || '%'
            	</when>
         	</choose>
    	</if>
	</select>

	<select id="getList" parameterType="hashmap" resultType="hashmap">
		SELECT C.*
		FROM(SELECT RANK() OVER(ORDER BY CARD_NO ASC) AS CARD_NO, CARD_CMP_NO, DECODE(CARD_TYPE, 0, '신용카드','체크카드') AS CARD_TYPE, CARD_NAME
	    FROM CARDS
	    ORDER BY CARD_NO ASC) C
		WHERE C.CARD_CMP_NO = ${cmpNo}
			<if test="searchTxt != null and searchTxt != ''">
	         	<choose>
	            	<when test="searchGbn == 0">
	            		AND (C.CARD_TYPE LIKE '%' || #{searchTxt} || '%' or C.CARD_NAME LIKE '%' || #{searchTxt} || '%')
	            	</when>
	            	<when test="searchGbn == 1"> <!-- 카드타입 -->
	            		AND C.CARD_TYPE LIKE '%' || #{searchTxt} || '%'
	            	</when>
	           		<when test="searchGbn == 2"> <!-- 카드명 -->
	           			AND C.CARD_NAME LIKE '%' || #{searchTxt} || '%'
	            	</when>
	         	</choose>
	    	</if>
	    	AND ROWNUM BETWEEN #{startCnt} AND #{endCnt}
	</select>
	
<!-- 	<delete id="deleteS" parameterType="hashmap">
		DELETE
		FROM SELL
		WHERE SELL_NO = #{sNo}
	</delete> -->
	
<!--	<select id = "getS" parameterType = "hashmap" resultType = "hashmap">
		SELECT SELL_NO , ITEM_NAME , COUNT , TO_CHAR(SELL_DT,'YYYY-MM-DD') AS S_DT
		FROM SELL
		WHERE SELL_NO = #{sNo}
	</select> -->
</mapper>